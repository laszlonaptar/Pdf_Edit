
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Arbeitsnachweis Generator</title>
</head>
<body>
    <h2>Arbeitsnachweis Kitöltés</h2>
    <form id="form">
        <label for="name">Név:</label><input type="text" id="name"><br>
        <label for="vorname">Utónév:</label><input type="text" id="vorname"><br>
        <label for="id">Azonosító:</label><input type="text" id="id"><br>
        <label for="start">Kezdés (óra):</label><input type="text" id="start"><br>
        <label for="end">Befejezés (óra):</label><input type="text" id="end"><br>
        <label for="hours">Össz. óra:</label><input type="text" id="hours"><br>
        <button type="button" onclick="generate()">Mentés</button>
    </form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        async function generate() {
            const response = await fetch('arbeitsnachweis_leeres_layout.xls');
            const blob = await response.blob();
            const arrayBuffer = await blob.arrayBuffer();
            const workbook = XLSX.read(arrayBuffer, { type: 'array' });
            const sheet = workbook.Sheets[workbook.SheetNames[0]];

            const name = document.getElementById("name").value;
            const vorname = document.getElementById("vorname").value;
            const id = document.getElementById("id").value;
            const start = document.getElementById("start").value;
            const end = document.getElementById("end").value;
            const hours = document.getElementById("hours").value;

            sheet["A7"] = { t: "s", v: name };
            sheet["B7"] = { t: "s", v: vorname };
            sheet["C7"] = { t: "s", v: id };
            sheet["D7"] = { t: "s", v: start };
            sheet["E7"] = { t: "s", v: end };
            sheet["F7"] = { t: "s", v: hours };
            sheet["F10"] = { t: "s", v: hours };

            const wbout = XLSX.write(workbook, { bookType: 'xls', type: 'array' });
            const xlsBlob = new Blob([wbout], { type: 'application/vnd.ms-excel' });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(xlsBlob);
            link.download = "arbeitsnachweis_kitoltott.xls";
            link.click();
        }
    </script>
</body>
</html>
